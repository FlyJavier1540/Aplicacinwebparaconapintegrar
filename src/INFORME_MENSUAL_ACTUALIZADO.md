# ðŸ“Š Informe Mensual de Actividades - Actualizado

## âœ… Cambios Implementados

He actualizado el diseÃ±o del **Informe Mensual de Actividades** de guardarecursos para que coincida exactamente con el formato oficial de CONAP que me mostraste.

---

## ðŸŽ¨ Nuevo DiseÃ±o

### Encabezado
- **âœ… Logo de CONAP** en la esquina superior izquierda
- **âœ… TÃ­tulo centrado**: "Consejo Nacional de Ãreas Protegidas"
- **âœ… SubtÃ­tulo**: "DirecciÃ³n Regional Altiplano Occidental"
- **âœ… Informe**: "Informe Mensual de Actividades 2025" (aÃ±o actual)
- **âœ… Guardarrecursos**: [Nombre completo del guardarecurso]
- **âœ… Ãrea Protegida**: [Nombre del Ã¡rea asignada]

### Tabla de Actividades
- **5 actividades estÃ¡ndar** (segÃºn formato CONAP):
  1. Patrullajes de control y vigilancia
  2. Actividades de PrevenciÃ³n y atenciÃ³n a incendios forestales
  3. Mantenimiento del Ã¡rea protegida
  4. ReforestaciÃ³n del Ã¡rea protegida
  5. Mantenimiento de reforestaciÃ³n

- **Columnas**:
  - No.
  - Actividad
  - Unidad de Medida (DÃ­a)
  - MES PROGRAMADO: Ene, Feb, Mar, Abr, May, Jun, Jul, Ago, Sep, Oct, Nov, Dic

- **Conteo de actividades**: En cada celda se muestra el **nÃºmero de actividades completadas** de ese tipo en ese mes especÃ­fico

### Pie de PÃ¡gina
- **âœ… Nota oficial**: "* Se adjunta el informe descriptivo en ____ hojas papel bond"
- **InformaciÃ³n del sistema**: Total de actividades y fecha de generaciÃ³n

---

## ðŸ“‹ Mapeo de Actividades

El sistema cuenta automÃ¡ticamente las actividades segÃºn su tipo:

| Tipo de Actividad (Sistema) | CategorÃ­a en Informe | No. |
|------------------------------|----------------------|-----|
| Patrullaje | Patrullajes de control y vigilancia | 1 |
| Patrullaje de Control y Vigilancia | Patrullajes de control y vigilancia | 1 |
| Control y Vigilancia | Patrullajes de control y vigilancia | 1 |
| Ronda | Patrullajes de control y vigilancia | 1 |
| PrevenciÃ³n de Incendios | Actividades de PrevenciÃ³n y atenciÃ³n a incendios forestales | 2 |
| AtenciÃ³n a Incendios Forestales | Actividades de PrevenciÃ³n y atenciÃ³n a incendios forestales | 2 |
| PrevenciÃ³n y AtenciÃ³n a Incendios Forestales | Actividades de PrevenciÃ³n y atenciÃ³n a incendios forestales | 2 |
| Mantenimiento | Mantenimiento del Ã¡rea protegida | 3 |
| Mantenimiento de Ãrea Protegida | Mantenimiento del Ã¡rea protegida | 3 |
| Mantenimiento del Ãrea Protegida | Mantenimiento del Ã¡rea protegida | 3 |
| EducaciÃ³n Ambiental | Mantenimiento del Ã¡rea protegida | 3 |
| InvestigaciÃ³n | Mantenimiento del Ã¡rea protegida | 3 |
| ReforestaciÃ³n | ReforestaciÃ³n del Ã¡rea protegida | 4 |
| ReforestaciÃ³n de Ãrea Protegida | ReforestaciÃ³n del Ã¡rea protegida | 4 |
| ReforestaciÃ³n del Ãrea Protegida | ReforestaciÃ³n del Ã¡rea protegida | 4 |
| Mantenimiento de ReforestaciÃ³n | Mantenimiento de reforestaciÃ³n | 5 |

---

## ðŸ“… Ejemplo de Informe Generado

### Datos del Guardarecurso
- **Guardarrecursos**: Juan PÃ©rez LÃ³pez
- **Ãrea Protegida**: Parque Nacional Laguna del Tigre
- **AÃ±o**: 2025

### Tabla de Actividades

| No. | Actividad | Unidad de Medida | Ene | Feb | Mar | Abr | May | Jun | Jul | Ago | Sep | Oct | Nov | Dic |
|-----|-----------|------------------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 1 | Patrullajes de control y vigilancia | DÃ­a | 5 | 8 | 12 | 10 | 7 | 9 | 11 | 6 | 8 | 10 | 5 | 7 |
| 2 | Actividades de PrevenciÃ³n y atenciÃ³n a incendios forestales | DÃ­a | 2 | 3 | 5 | 8 | 4 | 2 | 1 | 0 | 3 | 4 | 2 | 1 |
| 3 | Mantenimiento del Ã¡rea protegida | DÃ­a | 4 | 5 | 6 | 5 | 7 | 6 | 5 | 8 | 6 | 5 | 4 | 6 |
| 4 | ReforestaciÃ³n del Ã¡rea protegida | DÃ­a | 1 | 2 | 3 | 2 | 1 | 2 | 1 | 1 | 2 | 3 | 1 | 1 |
| 5 | Mantenimiento de reforestaciÃ³n | DÃ­a | 0 | 1 | 2 | 1 | 2 | 1 | 1 | 2 | 1 | 1 | 0 | 1 |

**Nota**: Los nÃºmeros representan el **conteo de actividades completadas** de ese tipo en cada mes del presente aÃ±o (2025).

---

## ðŸš€ CÃ³mo Generar el Informe

### Desde Coordinador o Administrador

1. **Ve a**: GestiÃ³n de Personal â†’ Registro de Guardarecursos
2. **Busca** al guardarecurso en la tabla
3. **Click** en el botÃ³n de **"Generar Informe"** (Ã­cono de documento)
4. **Resultado**: Se descarga automÃ¡ticamente el PDF con:
   - Logo de CONAP
   - Nombre del guardarecurso
   - Ãrea protegida asignada
   - Conteo de actividades por mes y tipo
   - Del presente aÃ±o (2025)

### Desde Guardarecurso

Los guardarecursos **NO** tienen acceso a generar informes. Solo Coordinadores y Administradores pueden generar informes.

---

## ðŸ“„ Archivos Modificados

### `/utils/reporteActividadesService.ts`
**Cambios principales**:
1. âœ… Actualizado `ACTIVIDAD_MAPPING` para mapear actividades a las 5 categorÃ­as
2. âœ… Actualizado `ACTIVIDADES_REPORTE` con las 5 actividades estÃ¡ndar
3. âœ… Modificado `agregarEncabezado()` para incluir:
   - Logo de CONAP
   - TÃ­tulos oficiales
   - Nombre del guardarrecurso
   - Ãrea protegida
4. âœ… Modificado `agregarTabla()` para formato "MES PROGRAMADO"
5. âœ… Modificado `agregarFooter()` para incluir nota oficial
6. âœ… Importado logo de CONAP desde `/src/logo.ts`

---

## ðŸ” Detalles TÃ©cnicos

### AgrupaciÃ³n de Actividades

El sistema agrupa las actividades de la siguiente manera:

1. **Filtra** todas las actividades del guardarecurso con estado "Completada"
2. **Agrupa** por tipo de actividad segÃºn `ACTIVIDAD_MAPPING`
3. **Cuenta** cuÃ¡ntas actividades de cada tipo se completaron en cada mes
4. **Genera** la tabla con los conteos

### CÃ³digo de AgrupaciÃ³n

```typescript
export function agruparActividadesPorTipoYMes(actividades: Actividad[]): ActividadesAgrupadas {
  const datosActividades: ActividadesAgrupadas = {};
  
  actividades.forEach((actividad: Actividad) => {
    const fecha = new Date(actividad.fecha);
    const mes = fecha.getMonth(); // 0-11 (Enero = 0, Diciembre = 11)
    const categoriaNo = ACTIVIDAD_MAPPING[actividad.tipo] || 12;
    const clave = `${categoriaNo}-${mes}`;
    
    if (!datosActividades[clave]) {
      datosActividades[clave] = 0;
    }
    datosActividades[clave]++; // Incrementar contador
  });

  return datosActividades;
}
```

### Ejemplo de Datos Agrupados

```javascript
{
  "1-0": 5,   // CategorÃ­a 1 (Patrullajes), Enero: 5 actividades
  "1-1": 8,   // CategorÃ­a 1 (Patrullajes), Febrero: 8 actividades
  "2-0": 2,   // CategorÃ­a 2 (Incendios), Enero: 2 actividades
  "3-5": 6,   // CategorÃ­a 3 (Mantenimiento), Junio: 6 actividades
  // ... etc
}
```

---

## ðŸ“Š Datos del AÃ±o Actual

El informe **siempre** se genera para el **aÃ±o actual** (2025).

Si se registran actividades de aÃ±os anteriores, **NO** aparecerÃ¡n en el informe.

Filtro aplicado:
```typescript
const aÃ±o = new Date().getFullYear(); // 2025
// Solo se cuentan actividades del aÃ±o 2025
```

---

## âœ… Validaciones y Seguridad

### Validaciones Implementadas

1. **Actividades completadas**: Solo cuenta actividades con estado "Completada"
2. **Guardarecurso especÃ­fico**: Solo cuenta actividades del guardarecurso seleccionado
3. **AÃ±o actual**: Solo cuenta actividades del presente aÃ±o
4. **Ãrea protegida**: Se muestra el nombre del Ã¡rea asignada desde la base de datos

### Seguridad

- âœ… Solo Coordinadores y Administradores pueden generar informes
- âœ… Cada informe es especÃ­fico para un guardarecurso
- âœ… Los datos se obtienen en tiempo real desde la base de datos

---

## ðŸŽ¯ PrÃ³ximos Pasos (Opcional)

Si necesitas agregar mÃ¡s funcionalidades:

1. **Filtro por rango de fechas**: Permitir generar informes de meses especÃ­ficos
2. **Exportar a Excel**: AdemÃ¡s de PDF, exportar a formato Excel
3. **GrÃ¡ficas**: Agregar grÃ¡ficas de barras para visualizar actividades por mes
4. **Firmas**: Agregar espacios para firmas del guardarecurso y coordinador
5. **Comparativa**: Comparar actividades de diferentes guardarecursos

---

## ðŸ“ Ejemplo de Uso

```typescript
// Generar informe desde componente
import { reporteActividadesService } from '../utils/reporteActividadesService';

const handleGenerarInforme = () => {
  const guardarecurso = {
    id: '123',
    nombre: 'Juan',
    apellido: 'PÃ©rez',
    areaAsignada: 'Parque Nacional Laguna del Tigre'
  };
  
  const resultado = reporteActividadesService.generarReporteActividadesMensual(
    guardarecurso,
    'Parque Nacional Laguna del Tigre' // Nombre del Ã¡rea desde BD
  );
  
  if (resultado.success) {
    console.log('âœ… Informe generado:', resultado.fileName);
    console.log('ðŸ“Š Total actividades:', resultado.totalActividades);
  }
};
```

---

**Ãšltima actualizaciÃ³n**: Noviembre 2025  
**VersiÃ³n**: v2.2 - Informe Mensual con DiseÃ±o Oficial CONAP  
**Estado**: âœ… Listo para usar
